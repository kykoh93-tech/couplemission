<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>å•æœº Mario é£æ ¼æ¸¸æˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
body {
  margin: 0;
  background: #87ceeb;
  font-family: Arial, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
}
canvas {
  background: #87ceeb;
  display: block;
  margin-top: 20px;
}
.controls {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 12px;
}
.btn {
  background: #22c55e;
  color: #fff;
  font-size: 24px;
  border-radius: 8px;
  width: 60px;
  height: 60px;
  display: flex;
  justify-content: center;
  align-items: center;
  user-select: none;
}
.btn:active { background: #16a34a; }
.scoreboard {
  margin-top: 10px;
  font-size: 18px;
}
</style>
</head>
<body>
<h3>å•æœº Mario é£æ ¼æ¸¸æˆ ğŸ…</h3>
<canvas id="game" width="360" height="240"></canvas>

<div class="controls">
  <div class="btn" onclick="moveLeft()">â¬…ï¸</div>
  <div class="btn" onclick="jump()">â¬†ï¸</div>
  <div class="btn" onclick="moveRight()">â¡ï¸</div>
</div>

<div class="scoreboard" id="scoreboard">å¾—åˆ†ï¼š0</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const gravity = 0.6;
const box = 20;

let player, platforms, tomatoes, score, keys, timer;

function startGame() {
  player = {x:50, y:180, w:20, h:20, dx:0, dy:0, onGround:false};
  platforms = [
    {x:0, y:200, w:360, h:40},
    {x:100, y:150, w:80, h:10},
    {x:220, y:120, w:80, h:10}
  ];
  tomatoes = [
    {x:120, y:120, w:10, h:10, collected:false},
    {x:240, y:90, w:10, h:10, collected:false}
  ];
  score = 0;
  updateScore();
  keys = {};
  clearInterval(timer);
  timer = setInterval(gameLoop, 20);
}

// æ§åˆ¶å‡½æ•°
function moveLeft(){ player.dx=-2; }
function moveRight(){ player.dx=2; }
function jump(){ if(player.onGround){ player.dy=-10; player.onGround=false; } }

// æ¸¸æˆå¾ªç¯
function gameLoop(){
  // ç§»åŠ¨
  player.x += player.dx;
  player.y += player.dy;

  // é‡åŠ›
  player.dy += gravity;

  // è¾¹ç•Œ
  if(player.x<0) player.x=0;
  if(player.x+player.w>canvas.width) player.x=canvas.width-player.w;
  if(player.y+player.h>canvas.height){ player.y=canvas.height-player.h; player.dy=0; player.onGround=true; }

  // å¹³å°ç¢°æ’
  player.onGround=false;
  platforms.forEach(p=>{
    if(player.x+player.w>p.x && player.x<p.x+p.w && player.y+player.h>p.y && player.y+player.h< p.y+p.h+player.dy){
      player.y=p.y-player.h;
      player.dy=0;
      player.onGround=true;
    }
  });

  // ç•ªèŒ„ç¢°æ’
  tomatoes.forEach(t=>{
    if(!t.collected && player.x+player.w>t.x && player.x<t.x+t.w && player.y+player.h>t.y && player.y<t.y+t.h){
      t.collected=true;
      score++;
      updateScore();
    }
  });

  // ç»˜åˆ¶
  draw();
}

// ç»˜åˆ¶å‡½æ•°
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // ç»˜åˆ¶å¹³å°
  ctx.fillStyle="#654321";
  platforms.forEach(p=>ctx.fillRect(p.x,p.y,p.w,p.h));

  // ç»˜åˆ¶ç•ªèŒ„ï¼ˆé‡‘å¸ï¼‰
  ctx.fillStyle="red";
  tomatoes.forEach(t=>{ if(!t.collected) ctx.fillRect(t.x,t.y,t.w,t.h); });

  // ç»˜åˆ¶ç©å®¶ï¼ˆMarioï¼‰
  ctx.fillStyle="blue";
  ctx.fillRect(player.x,player.y,player.w,player.h);
}

function updateScore(){ document.getElementById("scoreboard").textContent="å¾—åˆ†ï¼š"+score; }

startGame();
</script>
</body>
</html>

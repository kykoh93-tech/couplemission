<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>ç®€æ˜“ç‚¸å¼¹äººæ¸¸æˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
body { margin:0; background:#222; display:flex; flex-direction:column; align-items:center; font-family:Arial,sans-serif; }
canvas { background:#333; margin-top:20px; }
.controls { display:flex; justify-content:center; margin-top:10px; gap:10px; }
.btn { padding:10px 15px; font-size:20px; border-radius:8px; background:#22c55e; color:white; user-select:none; }
.btn:active { background:#16a34a; }
</style>
</head>
<body>
<h3 style="color:white;">ç®€æ˜“ç‚¸å¼¹äººæ¸¸æˆ</h3>
<canvas id="game" width="400" height="400"></canvas>
<div class="controls">
  <button class="btn" onclick="movePlayer(-1,0)">â¬…ï¸</button>
  <button class="btn" onclick="movePlayer(1,0)">â¡ï¸</button>
  <button class="btn" onclick="movePlayer(0,-1)">â¬†ï¸</button>
  <button class="btn" onclick="movePlayer(0,1)">â¬‡ï¸</button>
  <button class="btn" onclick="placeBomb()">ğŸ’£</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const tileSize = 40; 
const mapRows = 10, mapCols = 10;

let player = {x:1, y:1};
let bombs = [];
let explosionTime = 50; 
let walls = [];
let monsters = [];
let monsterTimer;

// 0 = ç©º, 1 = å›ºå®šå¢™, 2 = å¯ç‚¸å¢™
let map = [
[1,1,1,1,1,1,1,1,1,1],
[1,0,2,0,2,0,2,0,2,1],
[1,2,1,2,1,2,1,2,0,1],
[1,0,2,0,2,0,2,0,2,1],
[1,2,1,2,1,2,1,2,0,1],
[1,0,2,0,2,0,2,0,2,1],
[1,2,1,2,1,2,1,2,0,1],
[1,0,2,0,2,0,2,0,2,1],
[1,0,0,2,0,2,0,2,0,1],
[1,1,1,1,1,1,1,1,1,1],
];

// åˆå§‹åŒ–æ€ªç‰©
monsters.push({x:8,y:8});

// æ§åˆ¶ç©å®¶ç§»åŠ¨
function movePlayer(dx, dy){
  let nx = player.x + dx;
  let ny = player.y + dy;
  if(map[ny][nx] === 0){ player.x = nx; player.y = ny; }
}

// æ”¾ç½®ç‚¸å¼¹
function placeBomb(){
  bombs.push({x:player.x, y:player.y, timer:explosionTime});
}

// æ¸¸æˆå¾ªç¯
function gameLoop(){
  // æ›´æ–°ç‚¸å¼¹
  for(let i=bombs.length-1;i>=0;i--){
    bombs[i].timer--;
    if(bombs[i].timer<=0){
      explode(bombs[i]);
      bombs.splice(i,1);
    }
  }

  // ç§»åŠ¨æ€ªç‰©
  monsters.forEach(m=>{
    if(Math.random()<0.2){
      let dirs = [[1,0],[-1,0],[0,1],[0,-1]];
      let dir = dirs[Math.floor(Math.random()*4)];
      let nx = m.x + dir[0], ny = m.y + dir[1];
      if(map[ny][nx]===0) { m.x=nx; m.y=ny; }
    }
  });

  draw();
}

// ç‚¸å¼¹çˆ†ç‚¸
function explode(bomb){
  let bx=bomb.x, by=bomb.y;
  let dirs = [[1,0],[-1,0],[0,1],[0,-1]];
  dirs.forEach(d=>{
    for(let i=1;i<=1;i++){ // çˆ†ç‚¸èŒƒå›´1æ ¼
      let nx = bx + d[0]*i, ny = by + d[1]*i;
      if(map[ny][nx]===1) break; // å›ºå®šå¢™é˜»æŒ¡
      if(map[ny][nx]===2) map[ny][nx]=0; // å¯ç‚¸å¢™ç‚¸æ‰
    }
  });
  // ç‚¸æ‰è‡ªå·±æ ¼å­
  map[by][bx]=0;
}

// ç»˜åˆ¶åœ°å›¾
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  for(let y=0;y<mapRows;y++){
    for(let x=0;x<mapCols;x++){
      if(map[y][x]===1) ctx.fillStyle="#555";
      else if(map[y][x]===2) ctx.fillStyle="#aaa";
      else ctx.fillStyle="#333";
      ctx.fillRect(x*tileSize, y*tileSize, tileSize, tileSize);
      ctx.strokeStyle="#222";
      ctx.strokeRect(x*tileSize,y*tileSize,tileSize,tileSize);
    }
  }

  // ç»˜åˆ¶ç‚¸å¼¹
  ctx.fillStyle="orange";
  bombs.forEach(b=>{
    ctx.fillRect(b.x*tileSize+10,b.y*tileSize+10,20,20);
  });

  // ç»˜åˆ¶ç©å®¶
  ctx.fillStyle="blue";
  ctx.fillRect(player.x*tileSize+5,player.y*tileSize+5,30,30);

  // ç»˜åˆ¶æ€ªç‰©
  ctx.fillStyle="red";
  monsters.forEach(m=>{
    ctx.fillRect(m.x*tileSize+5,m.y*tileSize+5,30,30);
  });
}

setInterval(gameLoop, 100);
</script>
</body>
</html>
